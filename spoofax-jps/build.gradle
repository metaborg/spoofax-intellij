
intellij {
    type = "JPS"
}

task(printAllDependencies, description: 'Prints all runtime dependencies.') {
    doLast {
        def deps = configurations.runtime
        def jars = deps.resolve().collect { it.name }.findAll { !it.startsWith('tools.jar') }
        def jarList = [ "spoofax-jps-${metaborgVersion}.jar" ] + jars.sort()
        def depString = jarList.join('\n')

        def compileDependenciesResource = "${project.rootDir}/src/main/resources/compile_dependencies.txt"
        logger.info("Writing compile dependencies to $compileDependenciesResource:")
        new File("${project.rootDir}/src/main/resources/compile_dependencies.txt").text =
"""##################
# GENERATED FILE #
##################
# This file is generated by the :org.metaborg.jps:printAllDependencies task upon build
# Any modifications are discarded

""" + depString
        logger.info(depString)
    }
}

dependencies {
    compile     project(":spoofax-common")
}
